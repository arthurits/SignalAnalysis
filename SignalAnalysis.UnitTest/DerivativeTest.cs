namespace SignalAnalysis.UnitTest;

[TestClass]
public class DerivativeTest
{
    private readonly double[] sin1Hz = [0, 0.0627905195293134, 0.1253332335643040, 0.1873813145857250, 0.2486898871648550, 0.3090169943749470, 0.3681245526846780,
        0.4257792915650730, 0.4817536741017150, 0.5358267949789970, 0.5877852522924730, 0.6374239897486900, 0.6845471059286890, 0.7289686274214110, 0.7705132427757890,
        0.8090169943749470, 0.8443279255020150, 0.8763066800438640, 0.9048270524660200, 0.9297764858882510, 0.9510565162951540, 0.9685831611286310, 0.9822872507286890,
        0.9921147013144780, 0.9980267284282720, 1, 0.9980267284282720, 0.9921147013144780, 0.9822872507286890, 0.9685831611286310, 0.9510565162951530, 0.9297764858882510,
        0.9048270524660190, 0.8763066800438630, 0.8443279255020150, 0.8090169943749470, 0.7705132427757890, 0.7289686274214110, 0.6845471059286880, 0.6374239897486890,
        0.5877852522924720, 0.5358267949789960, 0.4817536741017140, 0.4257792915650720, 0.3681245526846770, 0.3090169943749460, 0.2486898871648540, 0.1873813145857230,
        0.1253332335643030, 0.0627905195293118, 0, -0.0627905195293147, -0.1253332335643060, -0.1873813145857260, -0.2486898871648560, -0.3090169943749490, -0.3681245526846800,
        -0.4257792915650740, -0.4817536741017170, -0.5358267949789980, -0.5877852522924740, -0.6374239897486910, -0.6845471059286900, -0.7289686274214130, -0.7705132427757900,
        -0.8090169943749490, -0.8443279255020160, -0.8763066800438640, -0.9048270524660200, -0.9297764858882520, -0.9510565162951540, -0.9685831611286320, -0.9822872507286890,
        -0.9921147013144780, -0.9980267284282720, -1, -0.9980267284282710, -0.9921147013144780, -0.9822872507286880, -0.9685831611286300, -0.9510565162951530,
        -0.9297764858882500, -0.9048270524660180, -0.8763066800438620, -0.8443279255020140, -0.8090169943749450, -0.7705132427757870, -0.7289686274214090, -0.6845471059286860,
        -0.6374239897486870, -0.5877852522924700, -0.5358267949789930, -0.4817536741017120, -0.4257792915650700, -0.3681245526846750, -0.3090169943749440, -0.2486898871648510,
        -0.1873813145857210, -0.1253332335643000, -0.0627905195293097, 0];

    private double[] Dsin1Hz = [6.283185307, 6.270786876, 6.233640514, 6.171892821, 6.085787487, 5.975664329, 5.841957955, 5.685196042, 5.505997257, 5.305068816,
        5.083203692, 4.841277486, 4.580244969, 4.301136318, 4.005053047, 3.693163661, 3.366699045, 3.026947607, 2.675250189, 2.312994781, 1.941611039, 1.562564645, 1.177351523,
        0.787491932, 0.39452447, 0, -0.39452447, -0.787491932, -1.177351523, -1.562564645, -1.941611039, -2.312994781, -2.675250189, -3.026947607, -3.366699045, -3.693163661,
        -4.005053047, -4.301136318, -4.580244969, -4.841277486, -5.083203692, -5.305068816, -5.505997257, -5.685196042, -5.841957955, -5.975664329, -6.085787487, -6.171892821,
        -6.233640514, -6.270786876, -6.283185307, -6.270786876, -6.233640514, -6.171892821, -6.085787487, -5.975664329, -5.841957955, -5.685196042, -5.505997257, -5.305068816,
        -5.083203692, -4.841277486, -4.580244969, -4.301136318, -4.005053047, -3.693163661, -3.366699045, -3.026947607, -2.675250189, -2.312994781, -1.941611039, -1.562564645,
        -1.177351523, -0.787491932, -0.39452447, 0, 0.39452447, 0.787491932, 1.177351523, 1.562564645, 1.941611039, 2.312994781, 2.675250189, 3.026947607, 3.366699045,
        3.693163661, 4.005053047, 4.301136318, 4.580244969, 4.841277486, 5.083203692, 5.305068816, 5.505997257, 5.685196042, 5.841957955, 5.975664329, 6.085787487, 6.171892821,
        6.233640514, 6.270786876, 6.283185307];

    private readonly double[] sin2Hz = [0, 0.0626666167821521, 0.1243449435824270, 0.1840622763423390, 0.2408768370508580, 0.2938926261462370, 0.3422735529643440,
        0.3852566213878950, 0.4221639627510080, 0.4524135262330100, 0.4755282581475770, 0.4911436253643440, 0.4990133642141360, 0.4990133642141360, 0.4911436253643440,
        0.4755282581475770, 0.4524135262330100, 0.4221639627510070, 0.3852566213878950, 0.3422735529643440, 0.2938926261462360, 0.2408768370508570, 0.1840622763423390,
        0.1243449435824270, 0.0626666167821516, 0, -0.0626666167821524, -0.1243449435824280, -0.1840622763423390, -0.2408768370508580, -0.2938926261462370, -0.3422735529643450,
        -0.3852566213878950, -0.4221639627510080, -0.4524135262330100, -0.4755282581475770, -0.4911436253643450, -0.4990133642141360, -0.4990133642141360, -0.4911436253643440,
        -0.4755282581475760, -0.4524135262330090, -0.4221639627510070, -0.3852566213878940, -0.3422735529643440, -0.2938926261462360, -0.2408768370508560, -0.1840622763423380,
        -0.1243449435824260, -0.0626666167821506, 0, 0.0626666167821534, 0.1243449435824290, 0.1840622763423400, 0.2408768370508590, 0.2938926261462380, 0.3422735529643460,
        0.3852566213878960, 0.4221639627510090, 0.4524135262330100, 0.4755282581475770, 0.4911436253643450, 0.4990133642141360, 0.4990133642141360, 0.4911436253643440,
        0.4755282581475760, 0.4524135262330090, 0.4221639627510070, 0.3852566213878930, 0.3422735529643430, 0.2938926261462350, 0.2408768370508560, 0.1840622763423360,
        0.1243449435824250, 0.0626666167821493, 0, -0.0626666167821551, -0.1243449435824300, -0.1840622763423420, -0.2408768370508600, -0.2938926261462390, -0.3422735529643470,
        -0.3852566213878960, -0.4221639627510090, -0.4524135262330110, -0.4755282581475780, -0.4911436253643450, -0.4990133642141360, -0.4990133642141360, -0.4911436253643440,
        -0.4755282581475760, -0.4524135262330080, -0.4221639627510060, -0.3852566213878930, -0.3422735529643420, -0.2938926261462340, -0.2408768370508540, -0.1840622763423360,
        -0.1243449435824230, -0.0626666167821485, 0];

    private double[] Dsin2Hz = [6.283185307, 6.233640514, 6.085787487, 5.841957955, 5.505997257, 5.083203692, 4.580244969, 4.005053047, 3.366699045, 2.675250189,
        1.941611039, 1.177351523, 0.39452447, -0.39452447, -1.177351523, -1.941611039, -2.675250189, -3.366699045, -4.005053047, -4.580244969, -5.083203692, -5.505997257,
        -5.841957955, -6.085787487, -6.233640514, -6.283185307, -6.233640514, -6.085787487, -5.841957955, -5.505997257, -5.083203692, -4.580244969, -4.005053047, -3.366699045,
        -2.675250189, -1.941611039, -1.177351523, -0.39452447, 0.39452447, 1.177351523, 1.941611039, 2.675250189, 3.366699045, 4.005053047, 4.580244969, 5.083203692,
        5.505997257, 5.841957955, 6.085787487, 6.233640514, 6.283185307, 6.233640514, 6.085787487, 5.841957955, 5.505997257, 5.083203692, 4.580244969, 4.005053047, 3.366699045,
        2.675250189, 1.941611039, 1.177351523, 0.39452447, -0.39452447, -1.177351523, -1.941611039, -2.675250189, -3.366699045, -4.005053047, -4.580244969, -5.083203692,
        -5.505997257, -5.841957955, -6.085787487, -6.233640514, -6.283185307, -6.233640514, -6.085787487, -5.841957955, -5.505997257, -5.083203692, -4.580244969, -4.005053047,
        -3.366699045, -2.675250189, -1.941611039, -1.177351523, -0.39452447, 0.39452447, 1.177351523, 1.941611039, 2.675250189, 3.366699045, 4.005053047, 4.580244969,
        5.083203692, 5.505997257, 5.841957955, 6.085787487, 6.233640514, 6.283185307];

    private readonly double[] sinSum = [0, 0.125457136311465, 0.249678177146732, 0.371443590928064, 0.489566724215712, 0.602909620521184, 0.710398105649022,
        0.811035912952967, 0.903917636852723, 0.988240321212006, 1.063313510440050, 1.128567615113030, 1.183560470142820, 1.227981991635550, 1.261656868140130,
        1.284545252522520, 1.296741451735020, 1.298470642794870, 1.290083673853910, 1.272050038852600, 1.244949142441390, 1.209459998179490, 1.166349527071030,
        1.116459644896900, 1.060693345210420, 1, 0.935360111646119, 0.867769757732050, 0.798224974386349, 0.727706324077773, 0.657163890148916, 0.587502932923906,
        0.519570431078124, 0.454142717292855, 0.391914399269005, 0.333488736227370, 0.279369617411444, 0.229955263207275, 0.185533741714552, 0.146280364384345,
        0.112256994144896, 0.083413268745986, 0.059589711350707, 0.040522670177178, 0.025850999720333, 0.015124368228711, 0.007813050113997, 0.003319038243386,
        0.000988289981877, 0.000123902747161, 0, -0.000123902747161, -0.000988289981877, -0.003319038243386, -0.007813050113997, -0.015124368228711, -0.025850999720334,
        -0.040522670177179, -0.059589711350708, -0.083413268745988, -0.112256994144897, -0.146280364384346, -0.185533741714554, -0.229955263207277, -0.279369617411447,
        -0.333488736227373, -0.391914399269007, -0.454142717292858, -0.519570431078127, -0.587502932923909, -0.657163890148920, -0.727706324077776, -0.798224974386353,
        -0.867769757732053, -0.935360111646122, -1, -1.060693345210430, -1.116459644896910, -1.166349527071030, -1.209459998179490, -1.244949142441390, -1.272050038852600,
        -1.290083673853910, -1.298470642794870, -1.296741451735020, -1.284545252522520, -1.261656868140130, -1.227981991635550, -1.183560470142820, -1.128567615113030,
        -1.063313510440050, -0.988240321212001, -0.903917636852718, -0.811035912952963, -0.710398105649016, -0.602909620521178, -0.489566724215705, -0.371443590928057,
        -0.249678177146724, -0.125457136311458, 0];

    private double[] DsinSum = [12.56637061, 12.50442739, 12.319428, 12.01385078, 11.59178474, 11.05886802, 10.42220292, 9.690249088, 8.872696302, 7.980319005,
        7.024814731, 6.018629009, 4.974769439, 3.906611848, 2.827701524, 1.751552622, 0.691448857, -0.339751439, -1.329802858, -2.267250189, -3.141592654, -3.943432612,
        -4.664606432, -5.298295555, -5.839116045, -6.283185307, -6.628164984, -6.873279418, -7.019309478, -7.068561902, -7.024814731, -6.89323975, -6.680303236, -6.393646652,
        -6.041949234, -5.6347747, -5.182404569, -4.695660788, -4.185720499, -3.663925963, -3.141592654, -2.629818627, -2.139298211, -1.680142995, -1.261712986, -0.892460637,
        -0.57979023, -0.329934866, -0.147853028, -0.037146362, 0, -0.037146362, -0.147853028, -0.329934866, -0.57979023, -0.892460637, -1.261712986, -1.680142995, -2.139298211,
        -2.629818627, -3.141592654, -3.663925963, -4.185720499, -4.695660788, -5.182404569, -5.6347747, -6.041949234, -6.393646652, -6.680303236, -6.89323975, -7.024814731,
        -7.068561902, -7.019309478, -6.873279418, -6.628164984, -6.283185307, -5.839116045, -5.298295555, -4.664606432, -3.943432612, -3.141592654, -2.267250189, -1.329802858,
        -0.339751439, 0.691448857, 1.751552622, 2.827701524, 3.906611848, 4.974769439, 6.018629009, 7.024814731, 7.980319005, 8.872696302, 9.690249088, 10.42220292, 11.05886802,
        11.59178474, 12.01385078, 12.319428, 12.50442739, 12.56637061];

    [TestMethod]
    public void Test_Derivative_BackwardOnePoint()
    {
        Dsin1Hz = [double.NaN, 6.279051952931340, 6.254271403499090, 6.204808102142040, 6.130857257913020, 6.032710721009260, 5.910755830973060, 5.765473888039470,
            5.597438253664260, 5.407312087728140, 5.195845731347650, 4.963873745621650, 4.712311617999890, 4.442152149272280, 4.154461535437780, 3.850375159915830,
            3.531093112706760, 3.197875454184860, 2.852037242215590, 2.494943342223190, 2.128003040690220, 1.752664483347750, 1.370408960005750, 0.982745058578915,
            0.591202711379368, 0.197327157172844, -0.197327157172844, -0.591202711379379, -0.982745058578915, -1.370408960005760, -1.752664483347750, -2.128003040690230,
            -2.494943342223190, -2.852037242215600, -3.197875454184850, -3.531093112706770, -3.850375159915830, -4.154461535437780, -4.442152149272290, -4.712311617999910,
            -4.963873745621670, -5.195845731347650, -5.407312087728140, -5.597438253664230, -5.765473888039470, -5.910755830973060, -6.032710721009270, -6.130857257913020,
            -6.204808102142040, -6.254271403499090, -6.279051952931330, -6.279051952931340, -6.254271403499090, -6.204808102142040, -6.130857257913020, -6.032710721009270,
            -5.910755830973050, -5.765473888039460, -5.597438253664260, -5.407312087728090, -5.195845731347650, -4.963873745621660, -4.712311617999880, -4.442152149272280,
            -4.154461535437770, -3.850375159915840, -3.531093112706730, -3.197875454184830, -2.852037242215600, -2.494943342223160, -2.128003040690220, -1.752664483347730,
            -1.370408960005750, -0.982745058578892, -0.591202711379368, -0.197327157172822, 0.197327157172866, 0.591202711379379, 0.982745058578948, 1.370408960005760,
            1.752664483347760, 2.128003040690240, 2.494943342223200, 2.852037242215630, 3.197875454184850, 3.531093112706800, 3.850375159915810, 4.154461535437820,
            4.442152149272270, 4.712311617999950, 4.963873745621630, 5.195845731347710, 5.407312087728110, 5.597438253664230, 5.765473888039520, 5.910755830973020,
            6.032710721009320, 6.130857257912980, 6.204808102142090, 6.254271403499050, 6.279051952931390];

        Dsin2Hz = [double.NaN, 6.266661678215210, 6.167832680027530, 5.971733275991160, 5.681456070851870, 5.301578909537890, 4.838092681810780, 4.298306842355030,
            3.690734136311290, 3.024956348200230, 2.311473191456700, 1.561536721676750, 0.786973884979148, 0, -0.786973884979141, -1.561536721676750, -2.311473191456710,
            -3.024956348200220, -3.690734136311280, -4.298306842355030, -4.838092681810780, -5.301578909537890, -5.681456070851870, -5.971733275991160, -6.167832680027530,
            -6.266661678215210, -6.266661678215190, -6.167832680027530, -5.971733275991160, -5.681456070851870, -5.301578909537890, -4.838092681810770, -4.298306842355010,
            -3.690734136311290, -3.024956348200220, -2.311473191456700, -1.561536721676750, -0.786973884979130, 0, 0.786973884979158, 1.561536721676770, 2.311473191456720,
            3.024956348200240, 3.690734136311280, 4.298306842355040, 4.838092681810790, 5.301578909537900, 5.681456070851880, 5.971733275991170, 6.167832680027530,
            6.266661678215210, 6.266661678215210, 6.167832680027530, 5.971733275991160, 5.681456070851860, 5.301578909537890, 4.838092681810760, 4.298306842355020,
            3.690734136311270, 3.024956348200180, 2.311473191456680, 1.561536721676740, 0.786973884979125, -0, -0.786973884979169, -1.561536721676800, -2.311473191456710,
            -3.024956348200220, -3.690734136311340, -4.298306842355020, -4.838092681810830, -5.301578909537870, -5.681456070851920, -5.971733275991130, -6.167832680027580,
            -6.266661678215170, -6.266661678215260, -6.167832680027480, -5.971733275991190, -5.681456070851810, -5.301578909537840, -4.838092681810790, -4.298306842354970,
            -3.690734136311290, -3.024956348200170, -2.311473191456680, -1.561536721676710, -0.786973884979108, 0, 0.786973884979191, 1.561536721676790, 2.311473191456760,
            3.024956348200240, 3.690734136311300, 4.298306842355090, 4.838092681810770, 5.301578909537960, 5.681456070851850, 5.971733275991220, 6.167832680027500,
            6.266661678215260];
        
        DsinSum = [double.NaN, 12.5457136311465000, 12.4221040835266000, 12.1765413781332000, 11.8123133287649000, 11.3342896305471000, 10.7488485127838000, 10.0637807303945000,
            9.2881723899755500, 8.4322684359283600, 7.5073189228043600, 6.5254104672984000, 5.4992855029790300, 4.4421521492723100, 3.3674876504586200, 2.2888384382390800,
            1.2196199212500600, 0.1729191059846260, -0.8386968940957020, -1.8033635001318400, -2.7100896411205600, -3.5489144261901400, -4.3110471108461300, -4.9889882174122400,
            -5.5766299686481600, -6.0693345210423700, -6.4639888353880400, -6.7590353914069100, -6.9544783345700700, -7.0518650308576200, -7.0542433928856600, -6.9660957225009900,
            -6.7932501845782000, -6.5427713785268800, -6.2228318023850700, -5.8425663041634700, -5.4119118815925700, -4.9414354204169100, -4.4421521492722800, -3.9253377330207500,
            -3.4023370239448900, -2.8843725398909400, -2.3823557395279100, -1.9067041173529500, -1.4671670456844400, -1.0726631491622700, -0.7311318114713690, -0.4494011870611430,
            -0.2330748261508750, -0.0864387234715588, -0.0123902747161245, -0.0123902747161258, -0.0864387234715629, -0.2330748261508830, -0.4494011870611570, -0.7311318114713800,
            -1.0726631491622900, -1.4671670456844500, -1.9067041173529900, -2.3823557395279100, -2.8843725398909700, -3.4023370239449200, -3.9253377330207600, -4.4421521492723000,
            -4.9414354204169400, -5.4119118815926400, -5.8425663041634400, -6.2228318023850500, -6.5427713785269300, -6.7932501845781900, -6.9660957225010500, -7.0542433928856100,
            -7.0518650308576700, -6.9544783345700200, -6.7590353914069500, -6.4639888353880000, -6.0693345210423900, -5.5766299686481100, -4.9889882174122400, -4.3110471108460400,
            -3.5489144261900700, -2.7100896411205600, -1.8033635001317700, -0.8386968940956800, 0.1729191059846920, 1.2196199212501000, 2.2888384382391000, 3.3674876504587300,
            4.4421521492723000, 5.4992855029791300, 6.5254104672984400, 7.5073189228044700, 8.4322684359283500, 9.2881723899755300, 10.0637807303946000, 10.7488485127838000,
            11.3342896305473000, 11.8123133287648000, 12.1765413781333000, 12.4221040835265000, 12.5457136311466000];

        var result = Derivative.Derivate(sin1Hz, DerivativeMethod.BackwardOnePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 1; i < Dsin1Hz.Length; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-12);

        result = Derivative.Derivate(sin2Hz, DerivativeMethod.BackwardOnePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 1; i < Dsin2Hz.Length; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-12);

        result = Derivative.Derivate(sinSum, DerivativeMethod.BackwardOnePoint, 0, sinSum.GetUpperBound(0), 100);
        for (int i = 1; i < DsinSum.Length; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-12);
        

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x), DerivativeMethod.BackwardOnePoint, 0, 1, 100);
        for (int i = 1; i < Dsin1Hz.Length; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-12);

        result = Derivative.Derivate((x) => 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.BackwardOnePoint, 0, 1, 100);
        for (int i = 1; i < Dsin2Hz.Length; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-12);

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x) + 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.BackwardOnePoint, 0, 1, 100);
        for (int i = 1; i < DsinSum.Length; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-12);
    }

    [TestMethod]
    public void Test_Derivative_ForwardOnePoint()
    {
        Dsin1Hz = [6.279051952931340, 6.254271403499090, 6.204808102142040, 6.130857257913020, 6.032710721009260, 5.910755830973060, 5.765473888039470, 5.597438253664260,
            5.407312087728140, 5.195845731347650, 4.963873745621650, 4.712311617999890, 4.442152149272280, 4.154461535437780, 3.850375159915830, 3.531093112706760,
            3.197875454184860, 2.852037242215590, 2.494943342223190, 2.128003040690220, 1.752664483347750, 1.370408960005750, 0.982745058578915, 0.591202711379368,
            0.197327157172844, -0.197327157172844, -0.591202711379379, -0.982745058578915, -1.370408960005760, -1.752664483347750, -2.128003040690230, -2.494943342223190,
            -2.852037242215600, -3.197875454184850, -3.531093112706770, -3.850375159915830, -4.154461535437780, -4.442152149272290, -4.712311617999910, -4.963873745621670,
            -5.195845731347650, -5.407312087728140, -5.597438253664230, -5.765473888039470, -5.910755830973060, -6.032710721009270, -6.130857257913020, -6.204808102142040,
            -6.254271403499090, -6.279051952931330, -6.279051952931340, -6.254271403499090, -6.204808102142040, -6.130857257913020, -6.032710721009270, -5.910755830973050,
            -5.765473888039460, -5.597438253664260, -5.407312087728090, -5.195845731347650, -4.963873745621660, -4.712311617999880, -4.442152149272280, -4.154461535437770,
            -3.850375159915840, -3.531093112706730, -3.197875454184830, -2.852037242215600, -2.494943342223160, -2.128003040690220, -1.752664483347730, -1.370408960005750,
            -0.982745058578892, -0.591202711379368, -0.197327157172822, 0.197327157172866, 0.591202711379379, 0.982745058578948, 1.370408960005760, 1.752664483347760,
            2.128003040690240, 2.494943342223200, 2.852037242215630, 3.197875454184850, 3.531093112706800, 3.850375159915810, 4.154461535437820, 4.442152149272270,
            4.712311617999950, 4.963873745621630, 5.195845731347710, 5.407312087728110, 5.597438253664230, 5.765473888039520, 5.910755830973020, 6.032710721009320,
            6.130857257912980, 6.204808102142090, 6.254271403499050, 6.279051952931390, double.NaN];

        Dsin2Hz = [6.266661678215210, 6.167832680027530, 5.971733275991160, 5.681456070851870, 5.301578909537890, 4.838092681810780, 4.298306842355030, 3.690734136311290,
            3.024956348200230, 2.311473191456700, 1.561536721676750, 0.786973884979148, 0, -0.786973884979141, -1.561536721676750, -2.311473191456710, -3.024956348200220,
            -3.690734136311280, -4.298306842355030, -4.838092681810780, -5.301578909537890, -5.681456070851870, -5.971733275991160, -6.167832680027530, -6.266661678215210,
            -6.266661678215190, -6.167832680027530, -5.971733275991160, -5.681456070851870, -5.301578909537890, -4.838092681810770, -4.298306842355010, -3.690734136311290,
            -3.024956348200220, -2.311473191456700, -1.561536721676750, -0.786973884979130, 0, 0.786973884979158, 1.561536721676770, 2.311473191456720, 3.024956348200240,
            3.690734136311280, 4.298306842355040, 4.838092681810790, 5.301578909537900, 5.681456070851880, 5.971733275991170, 6.167832680027530, 6.266661678215210,
            6.266661678215210, 6.167832680027530, 5.971733275991160, 5.681456070851860, 5.301578909537890, 4.838092681810760, 4.298306842355020, 3.690734136311270,
            3.024956348200180, 2.311473191456680, 1.561536721676740, 0.786973884979125, 0, -0.786973884979169, -1.561536721676800, -2.311473191456710, -3.024956348200220,
            -3.690734136311340, -4.298306842355020, -4.838092681810830, -5.301578909537870, -5.681456070851920, -5.971733275991130, -6.167832680027580, -6.266661678215170,
            -6.266661678215260, -6.167832680027480, -5.971733275991190, -5.681456070851810, -5.301578909537840, -4.838092681810790, -4.298306842354970, -3.690734136311290,
            -3.024956348200170, -2.311473191456680, -1.561536721676710, -0.786973884979108, 0, 0.786973884979191, 1.561536721676790, 2.311473191456760, 3.024956348200240,
            3.690734136311300, 4.298306842355090, 4.838092681810770, 5.301578909537960, 5.681456070851850, 5.971733275991220, 6.167832680027500, 6.266661678215260, double.NaN];

        DsinSum = [12.5457136311465000, 12.4221040835266000, 12.1765413781332000, 11.8123133287649000, 11.3342896305471000, 10.7488485127838000, 10.0637807303945000,
            9.2881723899755500, 8.4322684359283600, 7.5073189228043600, 6.5254104672984000, 5.4992855029790300, 4.4421521492723100, 3.3674876504586200, 2.2888384382390800,
            1.2196199212500600, 0.1729191059846260, -0.8386968940957020, -1.8033635001318400, -2.7100896411205600, -3.5489144261901400, -4.3110471108461300, -4.9889882174122400,
            -5.5766299686481600, -6.0693345210423700, -6.4639888353880400, -6.7590353914069100, -6.9544783345700700, -7.0518650308576200, -7.0542433928856600, -6.9660957225009900,
            -6.7932501845782000, -6.5427713785268800, -6.2228318023850700, -5.8425663041634700, -5.4119118815925700, -4.9414354204169100, -4.4421521492722800, -3.9253377330207500,
            -3.4023370239448900, -2.8843725398909400, -2.3823557395279100, -1.9067041173529500, -1.4671670456844400, -1.0726631491622700, -0.7311318114713690, -0.4494011870611430,
            -0.2330748261508750, -0.0864387234715588, -0.0123902747161245, -0.0123902747161258, -0.0864387234715629, -0.2330748261508830, -0.4494011870611570, -0.7311318114713800,
            -1.0726631491622900, -1.4671670456844500, -1.9067041173529900, -2.3823557395279100, -2.8843725398909700, -3.4023370239449200, -3.9253377330207600, -4.4421521492723000,
            -4.9414354204169400, -5.4119118815926400, -5.8425663041634400, -6.2228318023850500, -6.5427713785269300, -6.7932501845781900, -6.9660957225010500, -7.0542433928856100,
            -7.0518650308576700, -6.9544783345700200, -6.7590353914069500, -6.4639888353880000, -6.0693345210423900, -5.5766299686481100, -4.9889882174122400, -4.3110471108460400,
            -3.5489144261900700, -2.7100896411205600, -1.8033635001317700, -0.8386968940956800, 0.1729191059846920, 1.2196199212501000, 2.2888384382391000, 3.3674876504587300,
            4.4421521492723000, 5.4992855029791300, 6.5254104672984400, 7.5073189228044700, 8.4322684359283500, 9.2881723899755300, 10.0637807303946000, 10.7488485127838000,
            11.3342896305473000, 11.8123133287648000, 12.1765413781333000, 12.4221040835265000, 12.5457136311466000, double.NaN];

        var result = Derivative.Derivate(sin1Hz, DerivativeMethod.ForwardOnePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 0; i < Dsin1Hz.Length - 1; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-12);

        result = Derivative.Derivate(sin2Hz, DerivativeMethod.ForwardOnePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 0; i < Dsin2Hz.Length - 1; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-12);

        result = Derivative.Derivate(sinSum, DerivativeMethod.ForwardOnePoint, 0, sinSum.GetUpperBound(0), 100);
        for (int i = 0; i < DsinSum.Length - 1; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-12);


        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x), DerivativeMethod.ForwardOnePoint, 0, 1, 100);
        for (int i = 0; i < Dsin1Hz.Length - 1; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-12);

        result = Derivative.Derivate((x) => 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.ForwardOnePoint, 0, 1, 100);
        for (int i = 0; i < Dsin2Hz.Length - 1; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-12);

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x) + 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.ForwardOnePoint, 0, 1, 100);
        for (int i = 0; i < DsinSum.Length - 1; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-12);
    }

    [TestMethod]
    public void Test_Derivative_CenteredThreePoint()
    {
        var result = Derivative.Derivate(sin1Hz, DerivativeMethod.CenteredThreePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 1; i < Dsin1Hz.Length - 1; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-1);

        result = Derivative.Derivate(sin2Hz, DerivativeMethod.CenteredThreePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 1; i < Dsin2Hz.Length - 1; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-1);

        result = Derivative.Derivate(sinSum, DerivativeMethod.CenteredThreePoint, 0, sinSum.GetUpperBound(0), 100);
        for (int i = 1; i < DsinSum.Length - 1; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-1);


        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x), DerivativeMethod.CenteredThreePoint, 0, 1, 100);
        for (int i = 1; i < Dsin1Hz.Length - 1; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-1);

        result = Derivative.Derivate((x) => 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.CenteredThreePoint, 0, 1, 100);
        for (int i = 1; i < Dsin2Hz.Length - 1; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-1);

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x) + 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.CenteredThreePoint, 0, 1, 100);
        for (int i = 1; i < DsinSum.Length - 1; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-1);
    }

    [TestMethod]
    public void Test_Derivative_CenteredFivePoint()
    {
        var result = Derivative.Derivate(sin1Hz, DerivativeMethod.CenteredFivePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 2; i < Dsin1Hz.Length - 2; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-4);

        result = Derivative.Derivate(sin2Hz, DerivativeMethod.CenteredFivePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 2; i < Dsin2Hz.Length - 2; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-4);

        result = Derivative.Derivate(sinSum, DerivativeMethod.CenteredFivePoint, 0, sinSum.GetUpperBound(0), 100);
        for (int i = 2; i < DsinSum.Length - 2; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-4);


        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x), DerivativeMethod.CenteredFivePoint, 0, 1, 100);
        for (int i = 2; i < Dsin1Hz.Length - 2; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-4);

        result = Derivative.Derivate((x) => 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.CenteredFivePoint, 0, 1, 100);
        for (int i = 2; i < Dsin2Hz.Length - 2; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-4);

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x) + 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.CenteredFivePoint, 0, 1, 100);
        for (int i = 2; i < DsinSum.Length - 2; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-4);
    }

    [TestMethod]
    public void Test_Derivative_CenteredSevenPoint()
    {
        var result = Derivative.Derivate(sin1Hz, DerivativeMethod.CenteredSevenPoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 3; i < Dsin1Hz.Length - 3; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-6);

        result = Derivative.Derivate(sin2Hz, DerivativeMethod.CenteredSevenPoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 3; i < Dsin2Hz.Length - 3; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-6);

        result = Derivative.Derivate(sinSum, DerivativeMethod.CenteredSevenPoint, 0, sinSum.GetUpperBound(0), 100);
        for (int i = 3; i < DsinSum.Length - 3; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-6);


        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x), DerivativeMethod.CenteredSevenPoint, 0, 1, 100);
        for (int i = 3; i < Dsin1Hz.Length - 3; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-6);

        result = Derivative.Derivate((x) => 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.CenteredSevenPoint, 0, 1, 100);
        for (int i = 3; i < Dsin2Hz.Length - 3; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-6);

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x) + 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.CenteredSevenPoint, 0, 1, 100);
        for (int i = 3; i < DsinSum.Length - 3; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-6);
    }

    [TestMethod]
    public void Test_Derivative_CenteredNinePoint()
    {
        var result = Derivative.Derivate(sin1Hz, DerivativeMethod.CenteredNinePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 4; i < Dsin1Hz.Length - 4; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-9);

        result = Derivative.Derivate(sin2Hz, DerivativeMethod.CenteredNinePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 4; i < Dsin2Hz.Length - 4; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-9);

        result = Derivative.Derivate(sinSum, DerivativeMethod.CenteredNinePoint, 0, sinSum.GetUpperBound(0), 100);
        for (int i = 4; i < DsinSum.Length - 4; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-8);


        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x), DerivativeMethod.CenteredNinePoint, 0, 1, 100);
        for (int i = 4; i < Dsin1Hz.Length - 4; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-9);

        result = Derivative.Derivate((x) => 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.CenteredNinePoint, 0, 1, 100);
        for (int i = 4; i < Dsin2Hz.Length - 4; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-9);

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x) + 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.CenteredNinePoint, 0, 1, 100);
        for (int i = 4; i < DsinSum.Length - 4; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-8);
    }

    [TestMethod]
    public void Test_Derivative_SGLinearThreePoint()
    {
        var result = Derivative.Derivate(sin1Hz, DerivativeMethod.SGLinearThreePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 1; i < Dsin1Hz.Length - 1; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-1);

        result = Derivative.Derivate(sin2Hz, DerivativeMethod.SGLinearThreePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 1; i < Dsin2Hz.Length - 1; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-1);

        result = Derivative.Derivate(sinSum, DerivativeMethod.SGLinearThreePoint, 0, sinSum.GetUpperBound(0), 100);
        for (int i = 1; i < DsinSum.Length - 1; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-1);


        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x), DerivativeMethod.SGLinearThreePoint, 0, 1, 100);
        for (int i = 1; i < Dsin1Hz.Length - 1; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-1);

        result = Derivative.Derivate((x) => 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.SGLinearThreePoint, 0, 1, 100);
        for (int i = 1; i < Dsin2Hz.Length - 1; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-1);

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x) + 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.SGLinearThreePoint, 0, 1, 100);
        for (int i = 1; i < DsinSum.Length - 1; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-1);
    }

    [TestMethod]
    public void Test_Derivative_SGLinearFivePoint()
    {
        var result = Derivative.Derivate(sin1Hz, DerivativeMethod.SGLinearFivePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 2; i < Dsin1Hz.Length - 2; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-1);

        result = Derivative.Derivate(sin2Hz, DerivativeMethod.SGLinearFivePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 2; i < Dsin2Hz.Length - 2; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-1);

        result = Derivative.Derivate(sinSum, DerivativeMethod.SGLinearFivePoint, 0, sinSum.GetUpperBound(0), 100);
        for (int i = 2; i < DsinSum.Length - 2; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-1);


        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x), DerivativeMethod.SGLinearFivePoint, 0, 1, 100);
        for (int i = 2; i < Dsin1Hz.Length - 2; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-1);

        result = Derivative.Derivate((x) => 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.SGLinearFivePoint, 0, 1, 100);
        for (int i = 2; i < Dsin2Hz.Length - 2; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-1);

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x) + 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.SGLinearFivePoint, 0, 1, 100);
        for (int i = 2; i < DsinSum.Length - 2; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-1);
    }

    [TestMethod]
    public void Test_Derivative_SGLinearSevenPoint()
    {
        Dsin1Hz = [double.NaN, double.NaN, double.NaN, 6.143511647663760, 6.057802264775890, 5.948185503895540, 5.815093972298800, 5.659052921457110, 5.480678174109790,
            5.280673693892950, 5.059828807116630, 4.819015087654520, 4.559182917240030, 4.281357734743720, 3.986635989234680, 3.676180812796870, 3.351217430178200,
            3.013028323388230, 2.662948170327560, 2.302358577423890, 1.932682627062710, 1.555379261331230, 1.171937524240460, 0.783870685148836, 0.392710266579383,
            0, -0.392710266579389, -0.783870685148839, -1.171937524240460, -1.555379261331230, -1.932682627062720, -2.302358577423900, -2.662948170327560, -3.013028323388240,
            -3.351217430178210, -3.676180812796870, -3.986635989234680, -4.281357734743730, -4.559182917240030, -4.819015087654530, -5.059828807116630, -5.280673693892940,
            -5.480678174109790, -5.659052921457110, -5.815093972298790, -5.948185503895540, -6.057802264775890, -6.143511647663760, -6.204975396781790, -6.241950942792340,
            -6.254292360107860, -6.241950942792340, -6.204975396781800, -6.143511647663760, -6.057802264775890, -5.948185503895540, -5.815093972298790, -5.659052921457100,
            -5.480678174109780, -5.280673693892930, -5.059828807116620, -4.819015087654520, -4.559182917240020, -4.281357734743720, -3.986635989234670, -3.676180812796860,
            -3.351217430178190, -3.013028323388220, -2.662948170327540, -2.302358577423880, -1.932682627062710, -1.555379261331210, -1.171937524240450, -0.783870685148824,
            -0.392710266579369, 0, 0.392710266579403, 0.783870685148852, 1.171937524240480, 1.555379261331240, 1.932682627062730, 2.302358577423910, 2.662948170327580,
            3.013028323388250, 3.351217430178220, 3.676180812796880, 3.986635989234700, 4.281357734743740, 4.559182917240040, 4.819015087654540, 5.059828807116640,
            5.280673693892950, 5.480678174109790, 5.659052921457120, 5.815093972298790, 5.948185503895550, 6.057802264775890, 6.143511647663770, double.NaN, double.NaN, double.NaN];

        Dsin2Hz = [double.NaN, double.NaN, double.NaN, 5.735016325320120, 5.405205651374850, 4.990151655394060, 4.496399986835610, 3.931737404465590, 3.305068974521080,
            2.626277632495870, 1.906068323343980, 1.155799178102930, 0.387302389382242, -0.387302389382241, -1.155799178102930, -1.906068323343980, -2.626277632495870,
            -3.305068974521080, -3.931737404465600, -4.496399986835610, -4.990151655394070, -5.405205651374860, -5.735016325320120, -5.974382365882380, -6.119528827611650,
            -6.168166664100180, -6.119528827611650, -5.974382365882380, -5.735016325320110, -5.405205651374850, -4.990151655394060, -4.496399986835600, -3.931737404465590,
            -3.305068974521080, -2.626277632495860, -1.906068323343970, -1.155799178102920, -0.387302389382231, 0.387302389382257, 1.155799178102950, 1.906068323343990,
            2.626277632495880, 3.305068974521090, 3.931737404465600, 4.496399986835620, 4.990151655394070, 5.405205651374860, 5.735016325320120, 5.974382365882390,
            6.119528827611660, 6.168166664100200, 6.119528827611650, 5.974382365882380, 5.735016325320110, 5.405205651374850, 4.990151655394060, 4.496399986835590,
            3.931737404465580, 3.305068974521060, 2.626277632495840, 1.906068323343960, 1.155799178102910, 0.387302389382219, -0.387302389382266, -1.155799178102950,
            -1.906068323344000, -2.626277632495890, -3.305068974521100, -3.931737404465610, -4.496399986835630, -4.990151655394080, -5.405205651374870, -5.735016325320130,
            -5.974382365882400, -6.119528827611670, -6.168166664100170, -6.119528827611660, -5.974382365882370, -5.735016325320100, -5.405205651374830, -4.990151655394040,
            -4.496399986835580, -3.931737404465570, -3.305068974521050, -2.626277632495830, -1.906068323343950, -1.155799178102900, -0.387302389382203, 0.387302389382285,
            1.155799178102970, 1.906068323344020, 2.626277632495900, 3.305068974521120, 3.931737404465630, 4.496399986835630, 4.990151655394090, 5.405205651374880,
            5.735016325320130, double.NaN, double.NaN, double.NaN];

        DsinSum = [double.NaN, double.NaN, double.NaN, 11.878527972983900, 11.463007916150700, 10.938337159289600, 10.311493959134400, 9.590790325922710, 8.785747148630880,
            7.906951326388810, 6.965897130460610, 5.974814265757460, 4.946485306622270, 3.894055345361480, 2.830836811131750, 1.770112489452890, 0.724939797682331,
            -0.292040651132853, -1.268789234138040, -2.194041409411720, -3.057469028331350, -3.849826390043630, -4.563078801079660, -5.190511680733550, -5.726818561032270,
            -6.168166664100190, -6.512239094191040, -6.758253051031220, -6.906953849560580, -6.960584912706080, -6.922834282456780, -6.798758564259500, -6.594685574793150,
            -6.318097297909310, -5.977495062674060, -5.582249136140840, -5.142435167337610, -4.668660124125960, -4.171880527857770, -3.663215909551580, -3.153760483772640,
            -2.654396061397070, -2.175609199588700, -1.727315516991500, -1.318693985463180, -0.958033848501471, -0.652596613401027, -0.408495322343640, -0.230593030899408,
            -0.122422115180687, -0.086125696007657, -0.122422115180690, -0.230593030899414, -0.408495322343650, -0.652596613401040, -0.958033848501487, -1.318693985463190,
            -1.727315516991520, -2.175609199588720, -2.654396061397090, -3.153760483772660, -3.663215909551610, -4.171880527857800, -4.668660124125980, -5.142435167337630,
            -5.582249136140860, -5.977495062674080, -6.318097297909320, -6.594685574793160, -6.798758564259510, -6.922834282456790, -6.960584912706080, -6.906953849560570,
            -6.758253051031220, -6.512239094191030, -6.168166664100150, -5.726818561032260, -5.190511680733520, -4.563078801079630, -3.849826390043590, -3.057469028331310,
            -2.194041409411670, -1.268789234138000, -0.292040651132809, 0.724939797682384, 1.770112489452940, 2.830836811131800, 3.894055345361530, 4.946485306622330,
            5.974814265757520, 6.965897130460660, 7.906951326388860, 8.785747148630910, 9.590790325922740, 10.311493959134400, 10.938337159289600, 11.463007916150800,
            11.878527972983900, double.NaN, double.NaN, double.NaN];

        var result = Derivative.Derivate(sin1Hz, DerivativeMethod.SGLinearSevenPoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 3; i < Dsin1Hz.Length - 3; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-13);

        result = Derivative.Derivate(sin2Hz, DerivativeMethod.SGLinearSevenPoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 3; i < Dsin2Hz.Length - 3; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-13);

        result = Derivative.Derivate(sinSum, DerivativeMethod.SGLinearSevenPoint, 0, sinSum.GetUpperBound(0), 100);
        for (int i = 3; i < DsinSum.Length - 3; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-12);


        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x), DerivativeMethod.SGLinearSevenPoint, 0, 1, 100);
        for (int i = 3; i < Dsin1Hz.Length - 3; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-13);

        result = Derivative.Derivate((x) => 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.SGLinearSevenPoint, 0, 1, 100);
        for (int i = 3; i < Dsin2Hz.Length - 3; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-13);

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x) + 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.SGLinearSevenPoint, 0, 1, 100);
        for (int i = 3; i < DsinSum.Length - 3; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-13);
    }

    [TestMethod]
    public void Test_Derivative_SGLinearNinePoint()
    {
        Dsin1Hz = [double.NaN, double.NaN, double.NaN, double.NaN, 6.038665550906850, 5.929395071482480, 5.796723978593900, 5.641175864433080, 5.463364606343460,
            5.263991944126470, 5.043844710595170, 4.803791726304610, 4.544780370714010, 4.267832843312850, 3.974042129466500, 3.664567686902280, 3.340630869859590,
            3.003510108962640, 2.654535865838850, 2.295085382394690, 1.926577245470980, 1.550465788328810, 1.168235351060560, 0.781394422577632, 0.391469687293947,
            0, -0.391469687293951, -0.781394422577636, -1.168235351060560, -1.550465788328820, -1.926577245470980, -2.295085382394690, -2.654535865838860,
            -3.003510108962640, -3.340630869859600, -3.664567686902290, -3.974042129466500, -4.267832843312860, -4.544780370714020, -4.803791726304620, -5.043844710595170,
            -5.263991944126470, -5.463364606343460, -5.641175864433080, -5.796723978593900, -5.929395071482480, -6.038665550906850, -6.124104176205660, -6.185373760158050,
            -6.222232499707570, -6.234534930248410, -6.222232499707570, -6.185373760158050, -6.124104176205660, -6.038665550906850, -5.929395071482470, -5.796723978593890,
            -5.641175864433080, -5.463364606343450, -5.263991944126460, -5.043844710595160, -4.803791726304600, -4.544780370714000, -4.267832843312840, -3.974042129466480,
            -3.664567686902270, -3.340630869859580, -3.003510108962620, -2.654535865838850, -2.295085382394670, -1.926577245470960, -1.550465788328810, -1.168235351060550,
            -0.781394422577620, -0.391469687293932, 0, 0.391469687293964, 0.781394422577651, 1.168235351060580, 1.550465788328830, 1.926577245470990, 2.295085382394700,
            2.654535865838870, 3.003510108962660, 3.340630869859610, 3.664567686902300, 3.974042129466510, 4.267832843312870, 4.544780370714030, 4.803791726304620,
            5.043844710595180, 5.263991944126470, 5.463364606343470, 5.641175864433090, 5.796723978593900, 5.929395071482480, 6.038665550906860,
            double.NaN, double.NaN, double.NaN, double.NaN];

        Dsin2Hz = [double.NaN, double.NaN, double.NaN, double.NaN, 5.336855722314980, 4.927050168856280, 4.439542090957610, 3.882019782230640, 3.263275702531690,
            2.593067815617400, 1.881965700227190, 1.141183861512590, 0.382404871591728, -0.382404871591729, -1.141183861512580, -1.881965700227190, -2.593067815617400,
            -3.263275702531690, -3.882019782230650, -4.439542090957610, -4.927050168856280, -5.336855722314980, -5.662495872949700, -5.898835081056920, -6.042146136142610,
            -6.090168937258190, -6.042146136142610, -5.898835081056920, -5.662495872949690, -5.336855722314980, -4.927050168856280, -4.439542090957610, -3.882019782230640,
            -3.263275702531680, -2.593067815617390, -1.881965700227180, -1.141183861512570, -0.382404871591716, 0.382404871591741, 1.141183861512600, 1.881965700227200,
            2.593067815617410, 3.263275702531700, 3.882019782230660, 4.439542090957620, 4.927050168856290, 5.336855722314990, 5.662495872949700, 5.898835081056920,
            6.042146136142610, 6.090168937258210, 6.042146136142610, 5.898835081056920, 5.662495872949690, 5.336855722314970, 4.927050168856270, 4.439542090957600,
            3.882019782230630, 3.263275702531670, 2.593067815617380, 1.881965700227170, 1.141183861512560, 0.382404871591705, -0.382404871591749, -1.141183861512610,
            -1.881965700227210, -2.593067815617420, -3.263275702531710, -3.882019782230670, -4.439542090957630, -4.927050168856300, -5.336855722315000, -5.662495872949710,
            -5.898835081056940, -6.042146136142620, -6.090168937258180, -6.042146136142600, -5.898835081056920, -5.662495872949680, -5.336855722314960, -4.927050168856260,
            -4.439542090957590, -3.882019782230620, -3.263275702531660, -2.593067815617370, -1.881965700227160, -1.141183861512550, -0.382404871591687, 0.382404871591768,
            1.141183861512620, 1.881965700227230, 2.593067815617440, 3.263275702531730, 3.882019782230680, 4.439542090957640, 4.927050168856310, 5.336855722315010,
            double.NaN, double.NaN, double.NaN, double.NaN];

        DsinSum = [double.NaN, double.NaN, double.NaN, double.NaN, 11.375521273221800, 10.856445240338800, 10.236266069551500, 9.523195646663730, 8.726640308875160,
            7.857059759743870, 6.925810410822360, 5.944975587817200, 4.927185242305740, 3.885427971721120, 2.832858267953910, 1.782601986675100, 0.747563054242196,
            -0.259765593569052, -1.227483916391790, -2.144456708562930, -3.000472923385310, -3.786389933986170, -4.494260521889140, -5.117440658479290, -5.650676448848660,
            -6.090168937258200, -6.433615823436560, -6.680229503634560, -6.830731224010260, -6.887321510643800, -6.853627414327260, -6.734627473352290, -6.536555648069500,
            -6.266785811494330, -5.933698685476990, -5.546533387129470, -5.115225990979070, -4.650237714904570, -4.162375499122280, -3.662607864792020, -3.161879010367970,
            -2.670924128509060, -2.200088903811760, -1.759156082202430, -1.357181887636270, -1.002344902626190, -0.701809828591861, -0.461608303255958, -0.286538679101125,
            -0.180086363564963, -0.144365992990203, -0.180086363564966, -0.286538679101132, -0.461608303255968, -0.701809828591874, -1.002344902626200, -1.357181887636290,
            -1.759156082202450, -2.200088903811780, -2.670924128509080, -3.161879010367990, -3.662607864792040, -4.162375499122300, -4.650237714904590, -5.115225990979090,
            -5.546533387129480, -5.933698685477000, -6.266785811494340, -6.536555648069510, -6.734627473352300, -6.853627414327260, -6.887321510643800, -6.830731224010260,
            -6.680229503634560, -6.433615823436550, -6.090168937258170, -5.650676448848640, -5.117440658479260, -4.494260521889100, -3.786389933986130, -3.000472923385260,
            -2.144456708562890, -1.227483916391750, -0.259765593569008, 0.747563054242242, 1.782601986675140, 2.832858267953960, 3.885427971721180, 4.927185242305790,
            5.944975587817240, 6.925810410822410, 7.857059759743910, 8.726640308875200, 9.523195646663770, 10.236266069551500, 10.856445240338800, 11.375521273221900,
            double.NaN, double.NaN, double.NaN, double.NaN];

        var result = Derivative.Derivate(sin1Hz, DerivativeMethod.SGLinearNinePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 4; i < Dsin1Hz.Length - 4; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-13);

        result = Derivative.Derivate(sin2Hz, DerivativeMethod.SGLinearNinePoint, 0, sin1Hz.GetUpperBound(0), 100);
        for (int i = 4; i < Dsin2Hz.Length - 4; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-13);

        result = Derivative.Derivate(sinSum, DerivativeMethod.SGLinearNinePoint, 0, sinSum.GetUpperBound(0), 100);
        for (int i = 4; i < DsinSum.Length - 4; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-13);


        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x), DerivativeMethod.SGLinearNinePoint, 0, 1, 100);
        for (int i = 4; i < Dsin1Hz.Length - 4; i++)
            Assert.AreEqual(Dsin1Hz[i], result[i], 1e-13);

        result = Derivative.Derivate((x) => 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.SGLinearNinePoint, 0, 1, 100);
        for (int i = 4; i < Dsin2Hz.Length - 4; i++)
            Assert.AreEqual(Dsin2Hz[i], result[i], 1e-13);

        result = Derivative.Derivate((x) => Math.Sin(2 * Math.PI * 1 * x) + 0.5 * Math.Sin(2 * Math.PI * 2 * x), DerivativeMethod.SGLinearNinePoint, 0, 1, 100);
        for (int i = 4; i < DsinSum.Length - 4; i++)
            Assert.AreEqual(DsinSum[i], result[i], 1e-13);
    }

    [TestMethod]
    public void Test_Derivative_SGCubicFivePoint()
    {
        
    }

    [TestMethod]
    public void Test_Derivative_SGCubicSevenPoint()
    {

    }

    [TestMethod]
    public void Test_Derivative_SGCubicNinePoint()
    {

    }
}
